<!DOCTYPE html>

<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é˜¿å‡çš„åœ‹èªé­”æ³•æ£®æ—</title>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

```
    body {
        font-family: 'Nunito', -apple-system, BlinkMacSystemFont, 'Microsoft JhengHei', sans-serif;
        min-height: 100vh;
        background: linear-gradient(180deg, #87CEEB 0%, #98FB98 50%, #228B22 100%);
        overflow-x: hidden;
        position: relative;
    }

    /* æ£®æ—èƒŒæ™¯è£é£¾ */
    .forest-bg {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        pointer-events: none;
        z-index: 0;
        overflow: hidden;
    }

    .tree {
        position: absolute;
        bottom: 0;
        font-size: 4rem;
        opacity: 0.3;
        animation: sway 4s ease-in-out infinite;
    }

    .tree:nth-child(1) { left: 5%; animation-delay: 0s; }
    .tree:nth-child(2) { left: 15%; animation-delay: 0.5s; font-size: 5rem; }
    .tree:nth-child(3) { left: 25%; animation-delay: 1s; }
    .tree:nth-child(4) { right: 25%; animation-delay: 1.5s; font-size: 5rem; }
    .tree:nth-child(5) { right: 15%; animation-delay: 2s; }
    .tree:nth-child(6) { right: 5%; animation-delay: 2.5s; font-size: 4.5rem; }

    @keyframes sway {
        0%, 100% { transform: rotate(-2deg); }
        50% { transform: rotate(2deg); }
    }

    /* é£„è½æ¨¹è‘‰ */
    .leaf {
        position: absolute;
        font-size: 1.5rem;
        animation: falling linear infinite;
        opacity: 0.7;
    }

    @keyframes falling {
        0% {
            transform: translateY(-100px) rotate(0deg);
            opacity: 0;
        }
        10% { opacity: 0.7; }
        90% { opacity: 0.7; }
        100% {
            transform: translateY(100vh) rotate(720deg);
            opacity: 0;
        }
    }

    /* æ¼‚æµ®å‹•ç‰© */
    .floating-animal {
        position: absolute;
        font-size: 2rem;
        animation: float 6s ease-in-out infinite;
    }

    @keyframes float {
        0%, 100% { transform: translateY(0) translateX(0); }
        25% { transform: translateY(-20px) translateX(10px); }
        50% { transform: translateY(-10px) translateX(-5px); }
        75% { transform: translateY(-25px) translateX(5px); }
    }

    /* ä¸»å®¹å™¨ */
    .container {
        position: relative;
        z-index: 1;
        max-width: 900px;
        margin: 0 auto;
        padding: 20px;
        min-height: 100vh;
    }

    /* éŸ³æ•ˆæŒ‰éˆ• */
    .sound-btn {
        position: fixed;
        top: 20px;
        right: 20px;
        z-index: 100;
        background: rgba(255,255,255,0.9);
        border: none;
        border-radius: 50%;
        width: 50px;
        height: 50px;
        font-size: 1.5rem;
        cursor: pointer;
        box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        transition: all 0.3s;
    }

    .sound-btn:hover {
        transform: scale(1.1);
    }

    /* æ­¡è¿ç•«é¢ */
    .welcome-screen {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        min-height: 80vh;
        text-align: center;
        animation: fadeIn 1s ease;
    }

    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(30px); }
        to { opacity: 1; transform: translateY(0); }
    }

    .welcome-mascot {
        font-size: 6rem;
        margin-bottom: 20px;
        animation: bounce 2s ease-in-out infinite;
    }

    @keyframes bounce {
        0%, 100% { transform: translateY(0); }
        50% { transform: translateY(-20px); }
    }

    .welcome-title {
        font-size: 2.5rem;
        font-weight: 800;
        color: #15803d;
        text-shadow: 2px 2px 4px rgba(255,255,255,0.8);
        margin-bottom: 10px;
    }

    .welcome-subtitle {
        font-size: 1.3rem;
        color: #166534;
        margin-bottom: 30px;
    }

    .welcome-card {
        background: rgba(255,255,255,0.95);
        padding: 40px;
        border-radius: 30px;
        box-shadow: 0 10px 40px rgba(0,0,0,0.15);
        max-width: 400px;
        width: 100%;
    }

    .welcome-message {
        font-size: 1.2rem;
        color: #374151;
        margin-bottom: 25px;
        line-height: 1.8;
    }

    .name-input {
        width: 100%;
        padding: 15px 20px;
        font-size: 1.2rem;
        border: 3px solid #86efac;
        border-radius: 15px;
        margin-bottom: 20px;
        text-align: center;
        font-family: inherit;
        transition: all 0.3s;
    }

    .name-input:focus {
        outline: none;
        border-color: #22c55e;
        box-shadow: 0 0 15px rgba(34,197,94,0.3);
    }

    .start-btn {
        width: 100%;
        padding: 18px 30px;
        font-size: 1.3rem;
        font-weight: 700;
        color: white;
        background: linear-gradient(135deg, #22c55e, #16a34a);
        border: none;
        border-radius: 15px;
        cursor: pointer;
        transition: all 0.3s;
        box-shadow: 0 6px 20px rgba(34,197,94,0.4);
    }

    .start-btn:hover {
        transform: translateY(-3px);
        box-shadow: 0 10px 30px rgba(34,197,94,0.5);
    }

    .start-btn:active {
        transform: translateY(0);
    }

    /* ä¸»é¸å–® */
    .main-menu {
        display: none;
        animation: fadeIn 0.5s ease;
    }

    /* ç©å®¶è³‡è¨Šå¡ */
    .player-card {
        background: rgba(255,255,255,0.95);
        padding: 20px 30px;
        border-radius: 20px;
        box-shadow: 0 8px 30px rgba(0,0,0,0.1);
        display: flex;
        align-items: center;
        gap: 20px;
        margin-bottom: 30px;
        flex-wrap: wrap;
    }

    .player-avatar {
        font-size: 3.5rem;
        background: linear-gradient(135deg, #fef3c7, #fcd34d);
        padding: 15px;
        border-radius: 50%;
        box-shadow: 0 4px 15px rgba(251,191,36,0.3);
        animation: wiggle 2s ease-in-out infinite;
    }

    @keyframes wiggle {
        0%, 100% { transform: rotate(-3deg); }
        50% { transform: rotate(3deg); }
    }

    .player-info {
        flex: 1;
        min-width: 150px;
    }

    .player-name {
        font-size: 1.5rem;
        font-weight: 700;
        color: #374151;
    }

    .player-title {
        font-size: 0.95rem;
        color: #16a34a;
        font-weight: 600;
        background: #dcfce7;
        padding: 4px 12px;
        border-radius: 20px;
        display: inline-block;
        margin-top: 5px;
    }

    .player-stats {
        display: flex;
        gap: 25px;
        flex-wrap: wrap;
    }

    .stat-item {
        text-align: center;
    }

    .stat-icon {
        font-size: 1.8rem;
    }

    .stat-value {
        font-size: 1.2rem;
        font-weight: 700;
        color: #374151;
    }

    .stat-label {
        font-size: 0.8rem;
        color: #6b7280;
    }

    /* ç¶“é©—å€¼é€²åº¦æ¢ */
    .exp-bar-container {
        width: 100%;
        margin-top: 15px;
        padding-top: 15px;
        border-top: 1px solid #e5e7eb;
    }

    .exp-bar-label {
        font-size: 0.85rem;
        color: #6b7280;
        margin-bottom: 8px;
        display: flex;
        justify-content: space-between;
    }

    .exp-bar {
        height: 12px;
        background: #e5e7eb;
        border-radius: 10px;
        overflow: hidden;
        position: relative;
    }

    .exp-bar-fill {
        height: 100%;
        background: linear-gradient(90deg, #22c55e, #86efac);
        border-radius: 10px;
        transition: width 0.5s ease;
        position: relative;
    }

    .exp-bar-fill::after {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
        animation: shine 2s infinite;
    }

    @keyframes shine {
        from { transform: translateX(-100%); }
        to { transform: translateX(100%); }
    }

    /* é—œå¡é¸æ“‡å€ */
    .levels-title {
        font-size: 1.5rem;
        font-weight: 700;
        color: #15803d;
        text-align: center;
        margin-bottom: 25px;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 10px;
    }

    .levels-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
        gap: 20px;
    }

    .level-card {
        background: rgba(255,255,255,0.95);
        border-radius: 20px;
        overflow: hidden;
        box-shadow: 0 6px 25px rgba(0,0,0,0.1);
        cursor: pointer;
        transition: all 0.3s;
        position: relative;
    }

    .level-card:hover:not(.locked) {
        transform: translateY(-8px);
        box-shadow: 0 15px 40px rgba(0,0,0,0.15);
    }

    .level-card.locked {
        cursor: not-allowed;
        opacity: 0.7;
    }

    .level-header {
        height: 8px;
    }

    .level-header.mushroom { background: linear-gradient(90deg, #ef4444, #f97316); }
    .level-header.oak { background: linear-gradient(90deg, #22c55e, #84cc16); }
    .level-header.firefly { background: linear-gradient(90deg, #eab308, #facc15); }
    .level-header.treehouse { background: linear-gradient(90deg, #8b5cf6, #a855f7); }
    .level-header.rainbow { background: linear-gradient(90deg, #ec4899, #f43f5e, #f97316, #eab308, #22c55e, #06b6d4, #8b5cf6); }
    .level-header.synonym { background: linear-gradient(90deg, #06b6d4, #0ea5e9); }
    .level-header.antonym { background: linear-gradient(90deg, #ec4899, #d946ef); }
    .level-header.radical { background: linear-gradient(90deg, #f97316, #fb923c); }
    .level-header.measure { background: linear-gradient(90deg, #c026d3, #d946ef); }
    .level-header.hamster { background: linear-gradient(90deg, #fbbf24, #f59e0b, #f97316); }

    .level-content {
        padding: 25px 15px;
        text-align: center;
    }

    .level-icon {
        font-size: 3rem;
        margin-bottom: 10px;
    }

    .level-name {
        font-size: 1.1rem;
        font-weight: 700;
        color: #374151;
        margin-bottom: 5px;
    }

    .level-desc {
        font-size: 0.85rem;
        color: #6b7280;
        margin-bottom: 12px;
    }

    .level-progress {
        height: 6px;
        background: #e5e7eb;
        border-radius: 5px;
        overflow: hidden;
        margin-bottom: 8px;
    }

    .level-progress-fill {
        height: 100%;
        background: linear-gradient(90deg, #22c55e, #86efac);
        border-radius: 5px;
        transition: width 0.5s ease;
    }

    .level-score {
        font-size: 0.8rem;
        color: #9ca3af;
    }

    .level-lock-overlay {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0,0,0,0.5);
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        color: white;
        border-radius: 20px;
    }

    .lock-icon {
        font-size: 2.5rem;
        margin-bottom: 10px;
    }

    .lock-text {
        font-size: 0.85rem;
        font-weight: 600;
    }

    /* éŠæˆ²ç•«é¢ */
    .game-screen {
        display: none;
        animation: fadeIn 0.5s ease;
    }

    .game-header {
        background: rgba(255,255,255,0.95);
        padding: 15px 25px;
        border-radius: 20px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 25px;
        box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        flex-wrap: wrap;
        gap: 15px;
    }

    .game-level-name {
        font-size: 1.2rem;
        font-weight: 700;
        color: #15803d;
        display: flex;
        align-items: center;
        gap: 8px;
    }

    .game-progress {
        font-size: 1rem;
        color: #6b7280;
        font-weight: 600;
    }

    .game-hearts {
        display: flex;
        gap: 8px;
        font-size: 1.8rem;
    }

    .heart {
        transition: all 0.3s;
    }

    .heart.lost {
        filter: grayscale(100%);
        opacity: 0.4;
        transform: scale(0.9);
    }

    .back-btn {
        padding: 10px 20px;
        font-size: 1rem;
        font-weight: 600;
        color: #6b7280;
        background: #f3f4f6;
        border: none;
        border-radius: 10px;
        cursor: pointer;
        transition: all 0.3s;
    }

    .back-btn:hover {
        background: #e5e7eb;
        color: #374151;
    }

    /* é¡Œç›®å€ */
    .question-area {
        background: rgba(255,255,255,0.95);
        padding: 40px;
        border-radius: 30px;
        box-shadow: 0 10px 40px rgba(0,0,0,0.1);
        text-align: center;
    }

    .question-image {
        font-size: 5rem;
        margin-bottom: 20px;
        animation: pulse 2s ease-in-out infinite;
    }

    @keyframes pulse {
        0%, 100% { transform: scale(1); }
        50% { transform: scale(1.05); }
    }

    .question-text {
        font-size: 1.5rem;
        font-weight: 700;
        color: #374151;
        margin-bottom: 15px;
    }

    .question-hint {
        font-size: 1rem;
        color: #6b7280;
        margin-bottom: 30px;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
    }

    /* ç­”æ¡ˆæŒ‰éˆ• */
    .answers-grid {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 15px;
        max-width: 500px;
        margin: 0 auto;
    }

    .answer-btn {
        padding: 20px;
        font-size: 1.3rem;
        font-weight: 700;
        color: #374151;
        background: white;
        border: 3px solid #e5e7eb;
        border-radius: 15px;
        cursor: pointer;
        transition: all 0.3s;
        font-family: inherit;
    }

    .answer-btn:hover:not(:disabled) {
        border-color: #22c55e;
        background: #f0fdf4;
        transform: translateY(-3px);
    }

    .answer-btn.correct {
        background: #dcfce7;
        border-color: #22c55e;
        color: #15803d;
        animation: correct 0.5s ease;
    }

    @keyframes correct {
        0%, 100% { transform: scale(1); }
        50% { transform: scale(1.08); }
    }

    .answer-btn.wrong {
        background: #fee2e2;
        border-color: #ef4444;
        color: #dc2626;
        animation: wrong 0.5s ease;
    }

    @keyframes wrong {
        0%, 100% { transform: translateX(0); }
        25% { transform: translateX(-10px); }
        75% { transform: translateX(10px); }
    }

    .answer-btn:disabled {
        cursor: not-allowed;
        opacity: 0.7;
    }

    /* å­¸ç¿’æç¤ºå½ˆçª— */
    .modal-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0,0,0,0.6);
        display: none;
        align-items: center;
        justify-content: center;
        z-index: 1000;
        padding: 20px;
    }

    .modal-overlay.show {
        display: flex;
        animation: fadeIn 0.3s ease;
    }

    .modal-content {
        background: white;
        padding: 40px;
        border-radius: 30px;
        max-width: 450px;
        width: 100%;
        text-align: center;
        animation: modalSlide 0.3s ease;
    }

    @keyframes modalSlide {
        from { transform: translateY(50px); opacity: 0; }
        to { transform: translateY(0); opacity: 1; }
    }

    .modal-icon {
        font-size: 4rem;
        margin-bottom: 15px;
    }

    .modal-title {
        font-size: 1.5rem;
        font-weight: 700;
        color: #374151;
        margin-bottom: 20px;
    }

    .modal-answer {
        font-size: 2.5rem;
        font-weight: 800;
        color: #15803d;
        margin-bottom: 15px;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 15px;
    }

    .speak-btn {
        background: linear-gradient(135deg, #22c55e, #16a34a);
        border: none;
        border-radius: 50%;
        width: 50px;
        height: 50px;
        font-size: 1.5rem;
        color: white;
        cursor: pointer;
        transition: all 0.3s;
    }

    .speak-btn:hover {
        transform: scale(1.1);
    }

    .modal-hint {
        font-size: 1rem;
        color: #6b7280;
        margin-bottom: 15px;
        padding: 15px;
        background: #f3f4f6;
        border-radius: 15px;
    }

    .modal-your-answer {
        font-size: 0.9rem;
        color: #ef4444;
        margin-bottom: 25px;
    }

    .modal-btn {
        padding: 15px 40px;
        font-size: 1.1rem;
        font-weight: 700;
        color: white;
        background: linear-gradient(135deg, #22c55e, #16a34a);
        border: none;
        border-radius: 12px;
        cursor: pointer;
        transition: all 0.3s;
    }

    .modal-btn:hover {
        transform: translateY(-3px);
        box-shadow: 0 8px 25px rgba(34,197,94,0.4);
    }

    /* çµæœç•«é¢ */
    .result-screen {
        display: none;
        animation: fadeIn 0.5s ease;
    }

    .result-card {
        background: rgba(255,255,255,0.95);
        padding: 40px;
        border-radius: 30px;
        box-shadow: 0 10px 40px rgba(0,0,0,0.1);
        text-align: center;
        margin-bottom: 30px;
    }

    .result-icon {
        font-size: 5rem;
        margin-bottom: 20px;
    }

    .result-title {
        font-size: 2rem;
        font-weight: 800;
        margin-bottom: 15px;
    }

    .result-title.success { color: #15803d; }
    .result-title.retry { color: #f97316; }

    .result-message {
        font-size: 1.1rem;
        color: #6b7280;
        margin-bottom: 25px;
    }

    .result-stats {
        display: flex;
        justify-content: center;
        gap: 40px;
        margin-bottom: 30px;
        flex-wrap: wrap;
    }

    .result-stat {
        text-align: center;
    }

    .result-stat-value {
        font-size: 2.5rem;
        font-weight: 800;
        color: #22c55e;
    }

    .result-stat-label {
        font-size: 0.9rem;
        color: #6b7280;
    }

    .result-buttons {
        display: flex;
        gap: 15px;
        justify-content: center;
        flex-wrap: wrap;
    }

    .result-btn {
        padding: 15px 30px;
        font-size: 1.1rem;
        font-weight: 700;
        border: none;
        border-radius: 12px;
        cursor: pointer;
        transition: all 0.3s;
    }

    .result-btn.primary {
        color: white;
        background: linear-gradient(135deg, #22c55e, #16a34a);
    }

    .result-btn.secondary {
        color: #6b7280;
        background: #f3f4f6;
    }

    .result-btn:hover {
        transform: translateY(-3px);
    }

    /* è¤‡ç¿’å€åŸŸ */
    .review-section {
        background: rgba(255,255,255,0.95);
        padding: 30px;
        border-radius: 25px;
        box-shadow: 0 8px 30px rgba(0,0,0,0.1);
    }

    .review-title {
        font-size: 1.3rem;
        font-weight: 700;
        color: #374151;
        margin-bottom: 20px;
        display: flex;
        align-items: center;
        gap: 10px;
    }

    .review-subtitle {
        font-size: 1rem;
        font-weight: 600;
        color: #ef4444;
        margin-bottom: 15px;
        padding-bottom: 10px;
        border-bottom: 2px solid #fee2e2;
    }

    .review-subtitle.correct {
        color: #22c55e;
        border-color: #dcfce7;
        margin-top: 25px;
    }

    .review-items {
        display: grid;
        gap: 15px;
    }

    .review-item {
        background: #f9fafb;
        padding: 20px;
        border-radius: 15px;
        display: flex;
        align-items: center;
        gap: 20px;
        flex-wrap: wrap;
    }

    .review-item.wrong {
        background: #fef2f2;
        border-left: 4px solid #ef4444;
    }

    .review-item.right {
        background: #f0fdf4;
        border-left: 4px solid #22c55e;
    }

    .review-emoji {
        font-size: 2.5rem;
    }

    .review-content {
        flex: 1;
        min-width: 150px;
    }

    .review-answer {
        font-size: 1.3rem;
        font-weight: 700;
        color: #374151;
        display: flex;
        align-items: center;
        gap: 10px;
    }

    .review-hint {
        font-size: 0.9rem;
        color: #6b7280;
        margin-top: 5px;
    }

    .review-wrong-answer {
        font-size: 0.85rem;
        color: #ef4444;
        margin-top: 5px;
    }

    .review-speak-btn {
        background: #22c55e;
        border: none;
        border-radius: 50%;
        width: 40px;
        height: 40px;
        font-size: 1.2rem;
        color: white;
        cursor: pointer;
        transition: all 0.3s;
    }

    .review-speak-btn:hover {
        transform: scale(1.1);
        background: #16a34a;
    }

    /* éŸ¿æ‡‰å¼è¨­è¨ˆ */
    @media (max-width: 768px) {
        .welcome-title {
            font-size: 1.8rem;
        }

        .welcome-mascot {
            font-size: 4rem;
        }

        .welcome-card {
            padding: 30px 20px;
        }

        .player-card {
            flex-direction: column;
            text-align: center;
        }

        .player-stats {
            justify-content: center;
        }

        .levels-grid {
            grid-template-columns: repeat(2, 1fr);
        }

        .answers-grid {
            grid-template-columns: 1fr;
        }

        .question-image {
            font-size: 4rem;
        }

        .question-text {
            font-size: 1.2rem;
        }

        .answer-btn {
            padding: 18px;
            font-size: 1.2rem;
        }

        .modal-content {
            padding: 30px 20px;
        }

        .result-stats {
            gap: 25px;
        }
    }

    /* éš±è—é¡åˆ¥ */
    .hidden {
        display: none !important;
    }
</style>
```

</head>
<body>
    <!-- æ£®æ—èƒŒæ™¯ -->
    <div class="forest-bg">
        <div class="tree">ğŸŒ²</div>
        <div class="tree">ğŸŒ³</div>
        <div class="tree">ğŸŒ²</div>
        <div class="tree">ğŸŒ³</div>
        <div class="tree">ğŸŒ²</div>
        <div class="tree">ğŸŒ³</div>
    </div>

```
<!-- é£„è½æ¨¹è‘‰ (ç”± JS å‹•æ…‹ç”Ÿæˆ) -->
<div id="leaves-container"></div>

<!-- æ¼‚æµ®å‹•ç‰© -->
<div class="floating-animal" style="top: 15%; left: 10%;">ğŸ¦‹</div>
<div class="floating-animal" style="top: 25%; right: 8%; animation-delay: 1s;">ğŸ¿ï¸</div>
<div class="floating-animal" style="top: 60%; left: 5%; animation-delay: 2s;">ğŸ°</div>
<div class="floating-animal" style="top: 70%; right: 12%; animation-delay: 3s;">ğŸ¦”</div>

<!-- éŸ³æ•ˆé–‹é—œ -->
<button class="sound-btn" id="soundBtn" onclick="toggleSound()">ğŸ”Š</button>

<div class="container">
    <!-- æ­¡è¿ç•«é¢ -->
    <div class="welcome-screen" id="welcomeScreen">
        <div class="welcome-mascot">ğŸ¹</div>
        <h1 class="welcome-title">é˜¿å‡çš„åœ‹èªé­”æ³•æ£®æ— 2.0</h1>
        <p class="welcome-subtitle">å’Œå¯æ„›çš„å°å€‰é¼ ä¸€èµ·å­¸åœ‹èªï¼</p>
        
        <div class="welcome-card">
            <p class="welcome-message">
                ğŸ¹ æ­¡è¿ä¾†åˆ°é­”æ³•æ£®æ—ï¼<br>
                æº–å‚™å¥½äº†å—ï¼Ÿ<br>
                è·Ÿè‘—å¯æ„›çš„å°å€‰é¼ ä¸€èµ·å­¸åœ‹èªå§ï¼
            </p>
            <input type="text" class="name-input" id="nameInput" placeholder="è«‹è¼¸å…¥ä½ çš„åå­—" maxlength="10" value="é˜¿å‡">
            <button class="start-btn" onclick="startGame()">å‡ºç™¼æ¢éšªï¼ğŸŒ²</button>
        </div>
    </div>

    <!-- ä¸»é¸å–® -->
    <div class="main-menu" id="mainMenu">
        <!-- ç©å®¶è³‡è¨Šå¡ -->
        <div class="player-card">
            <div class="player-avatar">ğŸ¹</div>
            <div class="player-info">
                <div class="player-name" id="playerName">é˜¿å‡</div>
                <div class="player-title" id="playerTitle">Lv.1 æ£®æ—æ–°æ‰‹</div>
            </div>
            <div class="player-stats">
                <div class="stat-item">
                    <div class="stat-icon">ğŸª™</div>
                    <div class="stat-value" id="goldDisplay">0</div>
                    <div class="stat-label">é‡‘å¹£</div>
                </div>
                <div class="stat-item">
                    <div class="stat-icon">â­</div>
                    <div class="stat-value" id="expDisplay">0</div>
                    <div class="stat-label">ç¶“é©—å€¼</div>
                </div>
            </div>
            <div class="exp-bar-container">
                <div class="exp-bar-label">
                    <span>å‡ç´šé€²åº¦</span>
                    <span id="expProgress">0/100</span>
                </div>
                <div class="exp-bar">
                    <div class="exp-bar-fill" id="expBarFill" style="width: 0%"></div>
                </div>
            </div>
        </div>

        <!-- é—œå¡é¸æ“‡ -->
        <h2 class="levels-title">ğŸŒ² é¸æ“‡é—œå¡ ğŸŒ²</h2>
        <div class="levels-grid" id="levelsGrid">
            <!-- é—œå¡å¡ç‰‡ç”± JS å‹•æ…‹ç”Ÿæˆ -->
        </div>
    </div>

    <!-- éŠæˆ²ç•«é¢ -->
    <div class="game-screen" id="gameScreen">
        <div class="game-header">
            <button class="back-btn" onclick="backToMenu()">â† è¿”å›</button>
            <div class="game-level-name" id="gameLevelName">ğŸ„ è˜‘è‡æ–°æ‰‹æ‘</div>
            <div class="game-progress" id="gameProgress">ç¬¬ 1/10 é¡Œ</div>
            <div class="game-hearts" id="gameHearts">
                <span class="heart">â¤ï¸</span>
                <span class="heart">â¤ï¸</span>
                <span class="heart">â¤ï¸</span>
            </div>
        </div>

        <div class="question-area">
            <div class="question-image" id="questionImage">ğŸŒ¸</div>
            <div class="question-text" id="questionText">é€™æ˜¯ä»€éº¼ï¼Ÿ</div>
            <div class="question-hint">ğŸ’¡ <span id="questionHint">æ˜¥å¤©æœƒé–‹çš„ï¼Œæœ‰å¾ˆå¤šé¡è‰²</span></div>
            
            <div class="answers-grid" id="answersGrid">
                <!-- ç­”æ¡ˆæŒ‰éˆ•ç”± JS å‹•æ…‹ç”Ÿæˆ -->
            </div>
        </div>
    </div>

    <!-- çµæœç•«é¢ -->
    <div class="result-screen" id="resultScreen">
        <div class="result-card">
            <div class="result-icon" id="resultIcon">ğŸ‰</div>
            <h2 class="result-title" id="resultTitle">å¥½æ£’ï¼</h2>
            <p class="result-message" id="resultMessage">ä½ å®Œæˆäº†é€™å€‹é—œå¡ï¼</p>
            
            <div class="result-stats">
                <div class="result-stat">
                    <div class="result-stat-value" id="resultScore">8/10</div>
                    <div class="result-stat-label">ç­”å°é¡Œæ•¸</div>
                </div>
                <div class="result-stat">
                    <div class="result-stat-value" id="resultExp">+40</div>
                    <div class="result-stat-label">ç²å¾—ç¶“é©—</div>
                </div>
                <div class="result-stat">
                    <div class="result-stat-value" id="resultGold">+80</div>
                    <div class="result-stat-label">ç²å¾—é‡‘å¹£</div>
                </div>
            </div>

            <div class="result-buttons">
                <button class="result-btn secondary" onclick="backToMenu()">è¿”å›é¸å–®</button>
                <button class="result-btn primary" id="retryBtn" onclick="retryLevel()">å†ç©ä¸€æ¬¡</button>
            </div>
        </div>

        <!-- è¤‡ç¿’å€åŸŸ -->
        <div class="review-section" id="reviewSection">
            <h3 class="review-title">ğŸ“š å­¸ç¿’è¤‡ç¿’</h3>
            <div id="reviewContent">
                <!-- è¤‡ç¿’å…§å®¹ç”± JS å‹•æ…‹ç”Ÿæˆ -->
            </div>
        </div>
    </div>
</div>

<!-- å­¸ç¿’æç¤ºå½ˆçª— -->
<div class="modal-overlay" id="learnModal">
    <div class="modal-content">
        <div class="modal-icon">ğŸ˜¢</div>
        <h3 class="modal-title">æ²’é—œä¿‚ï¼Œæˆ‘å€‘ä¾†å­¸ç¿’ï¼</h3>
        <div class="modal-answer">
            <span id="modalAnswer">èŠ±</span>
            <button class="speak-btn" onclick="speakAnswer()">ğŸ”Š</button>
        </div>
        <div class="modal-hint">
            ğŸ’¡ <span id="modalHint">æ˜¥å¤©æœƒé–‹çš„ï¼Œæœ‰å¾ˆå¤šé¡è‰²</span>
        </div>
        <div class="modal-your-answer">
            ä½ çš„ç­”æ¡ˆï¼š<span id="modalYourAnswer">è‰</span>
        </div>
        <button class="modal-btn" onclick="closeLearnModal()">æˆ‘è¨˜ä½äº†ï¼</button>
    </div>
</div>

<script>
    // ===============================
    // é¡Œåº«è³‡æ–™
    // ===============================
    const questionBank = {
        // ç¬¬ä¸€é—œï¼šè˜‘è‡æ–°æ‰‹æ‘ï¼ˆåœ‹å­—èªè®€ï¼‰
        mushroom: [
            { emoji: 'ğŸŒ¸', question: 'é€™æ˜¯ä»€éº¼ï¼Ÿ', answer: 'èŠ±', options: ['èŠ±', 'è‰', 'æ¨¹', 'è‘‰'], hint: 'æ˜¥å¤©æœƒé–‹çš„ï¼Œæœ‰å¾ˆå¤šé¡è‰²' },
            { emoji: 'ğŸŒ™', question: 'é€™æ˜¯ä»€éº¼ï¼Ÿ', answer: 'æœˆ', options: ['æ—¥', 'æœˆ', 'æ˜Ÿ', 'é›²'], hint: 'æ™šä¸Šå‡ºç¾åœ¨å¤©ç©º' },
            { emoji: 'â­', question: 'é€™æ˜¯ä»€éº¼ï¼Ÿ', answer: 'æ˜Ÿ', options: ['æ˜Ÿ', 'æœˆ', 'æ—¥', 'å…‰'], hint: 'ä¸€é–ƒä¸€é–ƒäº®æ™¶æ™¶' },
            { emoji: 'ğŸŸ', question: 'é€™æ˜¯ä»€éº¼ï¼Ÿ', answer: 'é­š', options: ['é­š', 'é³¥', 'èŸ²', 'è²“'], hint: 'ä½åœ¨æ°´è£¡æœƒæ¸¸æ³³' },
            { emoji: 'ğŸ¦', question: 'é€™æ˜¯ä»€éº¼ï¼Ÿ', answer: 'é³¥', options: ['é³¥', 'é­š', 'ç‹—', 'è²“'], hint: 'æœ‰ç¿…è†€æœƒé£›' },
            { emoji: 'ğŸ‘€', question: 'é€™æ˜¯ä»€éº¼ï¼Ÿ', answer: 'çœ¼', options: ['çœ¼', 'è€³', 'å£', 'é¼»'], hint: 'ç”¨ä¾†çœ‹æ±è¥¿' },
            { emoji: 'ğŸ‘‚', question: 'é€™æ˜¯ä»€éº¼ï¼Ÿ', answer: 'è€³', options: ['è€³', 'çœ¼', 'å£', 'æ‰‹'], hint: 'ç”¨ä¾†è½è²éŸ³' },
            { emoji: 'ğŸ–ï¸', question: 'é€™æ˜¯ä»€éº¼ï¼Ÿ', answer: 'æ‰‹', options: ['æ‰‹', 'è…³', 'é ­', 'èº«'], hint: 'ç”¨ä¾†æ‹¿æ±è¥¿' },
            { emoji: 'ğŸ¦¶', question: 'é€™æ˜¯ä»€éº¼ï¼Ÿ', answer: 'è…³', options: ['è…³', 'æ‰‹', 'é ­', 'è‚š'], hint: 'ç”¨ä¾†èµ°è·¯' },
            { emoji: 'ğŸ’§', question: 'é€™æ˜¯ä»€éº¼ï¼Ÿ', answer: 'æ°´', options: ['æ°´', 'ç«', 'åœŸ', 'æœ¨'], hint: 'å£æ¸´è¦å–çš„' }
        ],
        
        // ç¬¬äºŒé—œï¼šæ©¡æ¨¹å°å¾‘ï¼ˆèªè©é…å°ï¼‰
        oak: [
            { emoji: 'â˜€ï¸', question: 'ã€Œå¤ªã€è¦é…ä»€éº¼å­—è®Šæˆå¤©ä¸Šçš„æ±è¥¿ï¼Ÿ', answer: 'å¤ªé™½', options: ['å¤ªé™½', 'å¤ªç©º', 'å¤ªå¤§', 'å¤ªå¥½'], hint: 'ç™½å¤©æœƒç™¼å…‰ç™¼ç†±' },
            { emoji: 'ğŸŒ™', question: 'ã€Œï¼¿äº®ã€ï¼Œå“ªå€‹è©æ˜¯å°çš„ï¼Ÿ', answer: 'æœˆäº®', options: ['æœˆäº®', 'æ˜äº®', 'å…‰äº®', 'é–ƒäº®'], hint: 'æ™šä¸Šåœ“åœ“çš„' },
            { emoji: 'ğŸŒº', question: 'ã€ŒèŠ±ï¼¿ã€ï¼Œç¨®å¾ˆå¤šèŠ±çš„åœ°æ–¹å«ä»€éº¼ï¼Ÿ', answer: 'èŠ±åœ’', options: ['èŠ±åœ’', 'èŠ±æœµ', 'èŠ±ç“¶', 'èŠ±é¦™'], hint: 'ç¨®å¾ˆå¤šèŠ±çš„åœ°æ–¹' },
            { emoji: 'ğŸ«', question: 'ã€Œï¼¿æ ¡ã€ï¼Œæˆ‘å€‘å»ä¸Šèª²çš„åœ°æ–¹ï¼Ÿ', answer: 'å­¸æ ¡', options: ['å­¸æ ¡', 'ä½æ ¡', 'å›æ ¡', 'åˆ°æ ¡'], hint: 'æˆ‘å€‘å»ä¸Šèª²çš„åœ°æ–¹' },
            { emoji: 'ğŸ‘¨â€ğŸ«', question: 'ã€Œè€ï¼¿ã€ï¼Œæ•™æˆ‘å€‘çŸ¥è­˜çš„äººï¼Ÿ', answer: 'è€å¸«', options: ['è€å¸«', 'è€äºº', 'è€è™', 'è€é¼ '], hint: 'æ•™æˆ‘å€‘çŸ¥è­˜çš„äºº' },
            { emoji: 'ğŸ‘¦ğŸ‘§', question: 'ã€ŒåŒï¼¿ã€ï¼Œä¸€èµ·ä¸Šèª²çš„æœ‹å‹ï¼Ÿ', answer: 'åŒå­¸', options: ['åŒå­¸', 'åŒäº‹', 'åŒæ„', 'åŒæ¨£'], hint: 'ä¸€èµ·ä¸Šèª²çš„æœ‹å‹' },
            { emoji: 'ğŸ’', question: 'ã€Œï¼¿åŒ…ã€ï¼Œè£èª²æœ¬çš„è¢‹å­ï¼Ÿ', answer: 'æ›¸åŒ…', options: ['æ›¸åŒ…', 'èƒŒåŒ…', 'éŒ¢åŒ…', 'çš®åŒ…'], hint: 'è£èª²æœ¬çš„è¢‹å­' },
            { emoji: 'âœï¸', question: 'ã€Œé‰›ï¼¿ã€ï¼Œç”¨ä¾†å¯«å­—çš„ï¼Ÿ', answer: 'é‰›ç­†', options: ['é‰›ç­†', 'æ¯›ç­†', 'å½©ç­†', 'åŸç­†'], hint: 'ç”¨ä¾†å¯«å­—çš„' },
            { emoji: 'ğŸŒ…', question: 'ã€Œæ—©ï¼¿ã€ï¼Œå¤ªé™½å‰›å‡ºä¾†çš„æ™‚å€™ï¼Ÿ', answer: 'æ—©ä¸Š', options: ['æ—©ä¸Š', 'æ—©å®‰', 'æ—©èµ·', 'æ—©é¤'], hint: 'å¤ªé™½å‰›å‡ºä¾†' },
            { emoji: 'ğŸŒƒ', question: 'ã€Œï¼¿ä¸Šã€ï¼Œæœˆäº®å‡ºä¾†çš„æ™‚å€™ï¼Ÿ', answer: 'æ™šä¸Š', options: ['æ™šä¸Š', 'æ—©ä¸Š', 'èº«ä¸Š', 'è·¯ä¸Š'], hint: 'æœˆäº®å‡ºä¾†äº†' }
        ],
        
        // ç¬¬ä¸‰é—œï¼šè¢ç«èŸ²æ± å¡˜ï¼ˆé€ å¥ç·´ç¿’ï¼‰
        firefly: [
            { emoji: 'ğŸ‘§ğŸ“š', question: 'å“ªå€‹å¥å­æ˜¯å°çš„ï¼Ÿ', answer: 'å¦¹å¦¹åœ¨çœ‹æ›¸', options: ['å¦¹å¦¹åœ¨çœ‹æ›¸', 'å¦¹å¦¹åœ¨æ›¸çœ‹', 'çœ‹æ›¸å¦¹å¦¹åœ¨', 'æ›¸åœ¨çœ‹å¦¹å¦¹'], hint: 'èª°åœ¨åšä»€éº¼äº‹' },
            { emoji: 'ğŸ•ğŸƒ', question: 'å“ªå€‹å¥å­æ˜¯å°çš„ï¼Ÿ', answer: 'å°ç‹—åœ¨è·‘æ­¥', options: ['å°ç‹—åœ¨è·‘æ­¥', 'è·‘æ­¥å°ç‹—åœ¨', 'å°ç‹—è·‘æ­¥åœ¨', 'åœ¨è·‘æ­¥å°ç‹—'], hint: 'å°å‹•ç‰©åœ¨é‹å‹•' },
            { emoji: 'ğŸ±ğŸ˜´', question: 'å“ªå€‹å¥å­æ˜¯å°çš„ï¼Ÿ', answer: 'å°è²“åœ¨ç¡è¦º', options: ['å°è²“åœ¨ç¡è¦º', 'ç¡è¦ºå°è²“åœ¨', 'åœ¨ç¡è¦ºå°è²“', 'å°è²“ç¡è¦ºåœ¨'], hint: 'å°å‹•ç‰©åœ¨ä¼‘æ¯' },
            { emoji: 'ğŸ‘¦ğŸ', question: 'å“ªå€‹å¥å­æ˜¯å°çš„ï¼Ÿ', answer: 'å¼Ÿå¼Ÿåœ¨åƒè˜‹æœ', options: ['å¼Ÿå¼Ÿåœ¨åƒè˜‹æœ', 'è˜‹æœå¼Ÿå¼Ÿåƒ', 'åƒè˜‹æœå¼Ÿå¼Ÿ', 'å¼Ÿå¼Ÿè˜‹æœåƒ'], hint: 'èª°åœ¨åƒä»€éº¼' },
            { emoji: 'ğŸŒ§ï¸â˜”', question: 'å“ªå€‹å¥å­æ˜¯å°çš„ï¼Ÿ', answer: 'å¤–é¢åœ¨ä¸‹é›¨', options: ['å¤–é¢åœ¨ä¸‹é›¨', 'ä¸‹é›¨å¤–é¢åœ¨', 'åœ¨ä¸‹é›¨å¤–é¢', 'å¤–é¢ä¸‹é›¨åœ¨'], hint: 'å¤©æ°£æ€éº¼äº†' },
            { emoji: 'ğŸ¦ğŸµ', question: 'å“ªå€‹å¥å­æ˜¯å°çš„ï¼Ÿ', answer: 'å°é³¥åœ¨å”±æ­Œ', options: ['å°é³¥åœ¨å”±æ­Œ', 'å”±æ­Œå°é³¥åœ¨', 'åœ¨å”±æ­Œå°é³¥', 'å°é³¥å”±æ­Œåœ¨'], hint: 'èª°åœ¨ç™¼å‡ºè²éŸ³' },
            { emoji: 'ğŸ‘¨â€ğŸ‘©â€ğŸ‘§ğŸ½ï¸', question: 'å“ªå€‹å¥å­æ˜¯å°çš„ï¼Ÿ', answer: 'å…¨å®¶åœ¨åƒé£¯', options: ['å…¨å®¶åœ¨åƒé£¯', 'åƒé£¯å…¨å®¶åœ¨', 'åœ¨åƒé£¯å…¨å®¶', 'å…¨å®¶åƒé£¯åœ¨'], hint: 'å¤§å®¶ä¸€èµ·åšä»€éº¼' },
            { emoji: 'ğŸ‘§ğŸ¨', question: 'å“ªå€‹å¥å­æ˜¯å°çš„ï¼Ÿ', answer: 'å§Šå§Šåœ¨ç•«ç•«', options: ['å§Šå§Šåœ¨ç•«ç•«', 'ç•«ç•«å§Šå§Šåœ¨', 'åœ¨ç•«ç•«å§Šå§Š', 'å§Šå§Šç•«ç•«åœ¨'], hint: 'èª°åœ¨å‰µä½œ' },
            { emoji: 'ğŸŒ»â˜€ï¸', question: 'å“ªå€‹å¥å­æ˜¯å°çš„ï¼Ÿ', answer: 'å‘æ—¥è‘µåœ¨æ›¬å¤ªé™½', options: ['å‘æ—¥è‘µåœ¨æ›¬å¤ªé™½', 'æ›¬å¤ªé™½å‘æ—¥è‘µ', 'å‘æ—¥è‘µæ›¬å¤ªé™½åœ¨', 'åœ¨æ›¬å¤ªé™½å‘æ—¥è‘µ'], hint: 'æ¤ç‰©åœ¨åšä»€éº¼' },
            { emoji: 'ğŸ¸ğŸ’¦', question: 'å“ªå€‹å¥å­æ˜¯å°çš„ï¼Ÿ', answer: 'é’è›™åœ¨è·³æ°´', options: ['é’è›™åœ¨è·³æ°´', 'è·³æ°´é’è›™åœ¨', 'åœ¨è·³æ°´é’è›™', 'é’è›™è·³æ°´åœ¨'], hint: 'å°å‹•ç‰©åœ¨ç©æ°´' }
        ],
        
        // ç¬¬å››é—œï¼šæ™ºæ…§æ¨¹å±‹ï¼ˆæˆèªå­¸ç¿’ï¼‰
        treehouse: [
            { emoji: 'ğŸ¢ğŸ‡ğŸƒ', question: 'é€™æ˜¯ä»€éº¼æˆèªï¼Ÿ', answer: 'é¾œå…”è³½è·‘', options: ['é¾œå…”è³½è·‘', 'ç‹å‡è™å¨', 'å®ˆæ ªå¾…å…”', 'äº•åº•ä¹‹è›™'], hint: 'çƒé¾œå’Œå…”å­æ¯”è³½è·‘æ­¥' },
            { emoji: 'ğŸ¦ŠğŸ¯ğŸ˜¤', question: 'é€™æ˜¯ä»€éº¼æˆèªï¼Ÿ', answer: 'ç‹å‡è™å¨', options: ['ç‹å‡è™å¨', 'é¾œå…”è³½è·‘', 'å®ˆæ ªå¾…å…”', 'ç•«è›‡æ·»è¶³'], hint: 'ç‹ç‹¸å€Ÿè€è™çš„å¨é¢¨' },
            { emoji: 'ğŸ¸â­•', question: 'é€™æ˜¯ä»€éº¼æˆèªï¼Ÿ', answer: 'äº•åº•ä¹‹è›™', options: ['äº•åº•ä¹‹è›™', 'ç‹å‡è™å¨', 'é¾œå…”è³½è·‘', 'å®ˆæ ªå¾…å…”'], hint: 'é’è›™åªçœ‹åˆ°å°å°çš„å¤©ç©º' },
            { emoji: 'ğŸŒ³ğŸ‡â³', question: 'é€™æ˜¯ä»€éº¼æˆèªï¼Ÿ', answer: 'å®ˆæ ªå¾…å…”', options: ['å®ˆæ ªå¾…å…”', 'é¾œå…”è³½è·‘', 'ç‹å‡è™å¨', 'äº•åº•ä¹‹è›™'], hint: 'å‚»å‚»ç­‰å…”å­æ’æ¨¹' },
            { emoji: 'ğŸŒ¸ğŸŒºğŸŒ·', question: 'é€™æ˜¯ä»€éº¼æˆèªï¼Ÿ', answer: 'ç™¾èŠ±é½Šæ”¾', options: ['ç™¾èŠ±é½Šæ”¾', 'æ˜¥æš–èŠ±é–‹', 'èŠ±å¥½æœˆåœ“', 'é³¥èªèŠ±é¦™'], hint: 'å¾ˆå¤šèŠ±ä¸€èµ·é–‹' },
            { emoji: 'ğŸ“šğŸ’ª', question: 'é€™æ˜¯ä»€éº¼æˆèªï¼Ÿ', answer: 'ç”¨åŠŸè®€æ›¸', options: ['ç”¨åŠŸè®€æ›¸', 'å°ˆå¿ƒä¸€æ„', 'å‹¤å‹åŠªåŠ›', 'èªçœŸå­¸ç¿’'], hint: 'å¾ˆèªçœŸçš„å­¸ç¿’' },
            { emoji: 'ğŸ¤ğŸ˜Š', question: 'é€™æ˜¯ä»€éº¼æˆèªï¼Ÿ', answer: 'äº’ç›¸å¹«åŠ©', options: ['äº’ç›¸å¹«åŠ©', 'åœ˜çµåˆä½œ', 'å‹æ„›å’Œå¹³', 'åŒå¿ƒå”åŠ›'], hint: 'å¤§å®¶ä¸€èµ·å¹«å¿™' },
            { emoji: 'ğŸ˜„ğŸ˜„ğŸ˜„', question: 'é€™æ˜¯ä»€éº¼æˆèªï¼Ÿ', answer: 'ç¬‘å£å¸¸é–‹', options: ['ç¬‘å£å¸¸é–‹', 'é–‹é–‹å¿ƒå¿ƒ', 'å¿«å¿«æ¨‚æ¨‚', 'å–œæ°£æ´‹æ´‹'], hint: 'å¸¸å¸¸ä¿æŒç¬‘å®¹' },
            { emoji: 'â˜€ï¸ğŸŒ¤ï¸', question: 'é€™æ˜¯ä»€éº¼æˆèªï¼Ÿ', answer: 'é¢¨å’Œæ—¥éº—', options: ['é¢¨å’Œæ—¥éº—', 'æ™´ç©ºè¬é‡Œ', 'è¬é‡Œç„¡é›²', 'æ˜¥æš–èŠ±é–‹'], hint: 'å¤©æ°£éå¸¸å¥½' },
            { emoji: 'ğŸ‘€ğŸ“–', question: 'é€™æ˜¯ä»€éº¼æˆèªï¼Ÿ', answer: 'å°ˆå¿ƒä¸€æ„', options: ['å°ˆå¿ƒä¸€æ„', 'ç”¨åŠŸè®€æ›¸', 'å…¨ç¥è²«æ³¨', 'èšç²¾æœƒç¥'], hint: 'å¾ˆå°ˆå¿ƒåšä¸€ä»¶äº‹' }
        ],
        
        // æ–°é—œå¡1ï¼šåŒç¾©è©é—œå¡
        synonym: [
            { emoji: 'ğŸ˜ŠğŸ˜„', question: 'å“ªå€‹è©å’Œã€Œå¿«æ¨‚ã€æ„æ€æœ€åƒï¼Ÿ', answer: 'é«˜èˆˆ', options: ['é«˜èˆˆ', 'å‚·å¿ƒ', 'ç”Ÿæ°£', 'å®³æ€•'], hint: 'é–‹å¿ƒçš„æ„Ÿè¦º' },
            { emoji: 'ğŸƒğŸ’¨', question: 'å“ªå€‹è©å’Œã€Œå¿«é€Ÿã€æ„æ€æœ€åƒï¼Ÿ', answer: 'è¿…é€Ÿ', options: ['è¿…é€Ÿ', 'ç·©æ…¢', 'åœæ­¢', 'ä¼‘æ¯'], hint: 'å¾ˆå¿«çš„æ¨£å­' },
            { emoji: 'ğŸ’ªğŸ¦¸', question: 'å“ªå€‹è©å’Œã€Œå‹‡æ•¢ã€æ„æ€æœ€åƒï¼Ÿ', answer: 'è†½å¤§', options: ['è†½å¤§', 'è†½å°', 'å®³æ€•', 'èº²è—'], hint: 'ä¸æ€•å±éšª' },
            { emoji: 'ğŸ ğŸ¡', question: 'å“ªå€‹è©å’Œã€Œæˆ¿å­ã€æ„æ€æœ€åƒï¼Ÿ', answer: 'ä½å®…', options: ['ä½å®…', 'é¦¬è·¯', 'å…¬åœ’', 'å•†åº—'], hint: 'ä½çš„åœ°æ–¹' },
            { emoji: 'ğŸğŸ¥—', question: 'å“ªå€‹è©å’Œã€Œé£Ÿç‰©ã€æ„æ€æœ€åƒï¼Ÿ', answer: 'é£Ÿå“', options: ['é£Ÿå“', 'ç©å…·', 'è¡£æœ', 'æ›¸æœ¬'], hint: 'å¯ä»¥åƒçš„æ±è¥¿' },
            { emoji: 'ğŸ‘©â€ğŸ«ğŸ“š', question: 'å“ªå€‹è©å’Œã€Œæ•™å°ã€æ„æ€æœ€åƒï¼Ÿ', answer: 'æ•™å­¸', options: ['æ•™å­¸', 'ç©è€', 'ç¡è¦º', 'åƒé£¯'], hint: 'è€å¸«åšçš„äº‹' },
            { emoji: 'ğŸŒŸâœ¨', question: 'å“ªå€‹è©å’Œã€Œç¾éº—ã€æ„æ€æœ€åƒï¼Ÿ', answer: 'æ¼‚äº®', options: ['æ¼‚äº®', 'é†œé™‹', 'éª¯é«’', 'ç ´èˆŠ'], hint: 'å¥½çœ‹çš„æ¨£å­' },
            { emoji: 'ğŸ“–ğŸ“š', question: 'å“ªå€‹è©å’Œã€Œé–±è®€ã€æ„æ€æœ€åƒï¼Ÿ', answer: 'çœ‹æ›¸', options: ['çœ‹æ›¸', 'å¯«å­—', 'ç•«ç•«', 'å”±æ­Œ'], hint: 'çœ‹æ›¸çš„å‹•ä½œ' },
            { emoji: 'ğŸğŸ‰', question: 'å“ªå€‹è©å’Œã€Œç¦®ç‰©ã€æ„æ€æœ€åƒï¼Ÿ', answer: 'è´ˆå“', options: ['è´ˆå“', 'åƒåœ¾', 'å·¥å…·', 'é£Ÿç‰©'], hint: 'é€äººçš„æ±è¥¿' },
            { emoji: 'ğŸŒ§ï¸ğŸ’§', question: 'å“ªå€‹è©å’Œã€Œæ½®æ¿•ã€æ„æ€æœ€åƒï¼Ÿ', answer: 'æ¿•æ½¤', options: ['æ¿•æ½¤', 'ä¹¾ç‡¥', 'ç‚ç†±', 'å¯’å†·'], hint: 'æœ‰æ°´åˆ†çš„æ¨£å­' }
        ],
        
        // æ–°é—œå¡2ï¼šåç¾©è©é—œå¡
        antonym: [
            { emoji: 'â˜€ï¸ğŸŒ™', question: 'ã€Œç™½å¤©ã€çš„ç›¸åæ˜¯ä»€éº¼ï¼Ÿ', answer: 'é»‘å¤œ', options: ['é»‘å¤œ', 'ä¸­åˆ', 'æ—©æ™¨', 'å‚æ™š'], hint: 'å¤ªé™½ä¸‹å±±å¾Œ' },
            { emoji: 'ğŸ˜ŠğŸ˜¢', question: 'ã€Œå¿«æ¨‚ã€çš„ç›¸åæ˜¯ä»€éº¼ï¼Ÿ', answer: 'æ‚²å‚·', options: ['æ‚²å‚·', 'é«˜èˆˆ', 'é–‹å¿ƒ', 'æ„‰å¿«'], hint: 'ä¸é–‹å¿ƒçš„æ„Ÿè¦º' },
            { emoji: 'ğŸ”¥â„ï¸', question: 'ã€Œç‚ç†±ã€çš„ç›¸åæ˜¯ä»€éº¼ï¼Ÿ', answer: 'å¯’å†·', options: ['å¯’å†·', 'æº«æš–', 'èˆ’é©', 'æ¶¼çˆ½'], hint: 'å¾ˆå†·çš„å¤©æ°£' },
            { emoji: 'â¬†ï¸â¬‡ï¸', question: 'ã€Œå‘ä¸Šã€çš„ç›¸åæ˜¯ä»€éº¼ï¼Ÿ', answer: 'å‘ä¸‹', options: ['å‘ä¸‹', 'å‘å‰', 'å‘å¾Œ', 'æ—é‚Š'], hint: 'å¾€åœ°é¢çš„æ–¹å‘' },
            { emoji: 'ğŸ˜ğŸ­', question: 'ã€Œå·¨å¤§ã€çš„ç›¸åæ˜¯ä»€éº¼ï¼Ÿ', answer: 'æ¸ºå°', options: ['æ¸ºå°', 'é¾å¤§', 'å¯¬å»£', 'é«˜å¤§'], hint: 'å¾ˆå°çš„æ¨£å­' },
            { emoji: 'ğŸƒğŸŒ', question: 'ã€Œå¿«é€Ÿã€çš„ç›¸åæ˜¯ä»€éº¼ï¼Ÿ', answer: 'ç·©æ…¢', options: ['ç·©æ…¢', 'è¿…é€Ÿ', 'æ€¥ä¿ƒ', 'é£›å¿«'], hint: 'æ…¢ååçš„' },
            { emoji: 'â•â–', question: 'ã€Œå¢åŠ ã€çš„ç›¸åæ˜¯ä»€éº¼ï¼Ÿ', answer: 'æ¸›å°‘', options: ['æ¸›å°‘', 'å¢å¤š', 'ç´¯ç©', 'å †ç©'], hint: 'è®Šå¾—æ›´å°‘' },
            { emoji: 'ğŸ˜´ğŸ˜ƒ', question: 'ã€Œç–²å€¦ã€çš„ç›¸åæ˜¯ä»€éº¼ï¼Ÿ', answer: 'ç²¾ç¥', options: ['ç²¾ç¥', 'å‹ç´¯', 'çå€¦', 'ç„¡åŠ›'], hint: 'å……æ»¿æ´»åŠ›' },
            { emoji: 'ğŸ”ŠğŸ”‡', question: 'ã€Œå®‰éœã€çš„ç›¸åæ˜¯ä»€éº¼ï¼Ÿ', answer: 'åµé¬§', options: ['åµé¬§', 'å¯§éœ', 'å¹³å’Œ', 'æ²‰é»˜'], hint: 'å¾ˆå¤§è²éŸ³' },
            { emoji: 'ğŸŒˆğŸŒ§ï¸', question: 'ã€Œæ™´æœ—ã€çš„ç›¸åæ˜¯ä»€éº¼ï¼Ÿ', answer: 'é™°é›¨', options: ['é™°é›¨', 'æ¸…æ¾ˆ', 'æ˜äº®', 'ç‡¦çˆ›'], hint: 'ä¸‹é›¨çš„å¤©æ°£' }
        ],
        
        // æ–°é—œå¡3ï¼šéƒ¨é¦–é—œå¡
        radical: [
            { emoji: 'ğŸŒŠğŸ’§', question: 'ã€Œæµ·ã€æ²³ã€æ± ã€éƒ½æœ‰ä»€éº¼éƒ¨é¦–ï¼Ÿ', answer: 'æ°´', options: ['æ°´', 'æœ¨', 'ç«', 'åœŸ'], hint: 'éƒ½å’Œæ°´æœ‰é—œ' },
            { emoji: 'ğŸŒ³ğŸŒ²', question: 'ã€Œæ¨¹ã€æ—ã€æ£®ã€éƒ½æœ‰ä»€éº¼éƒ¨é¦–ï¼Ÿ', answer: 'æœ¨', options: ['æœ¨', 'æ°´', 'äºº', 'å£'], hint: 'éƒ½å’Œæ¨¹æœ¨æœ‰é—œ' },
            { emoji: 'ğŸ‘«ğŸ‘¨', question: 'ã€Œä»–ã€ä½ ã€å€‘ã€éƒ½æœ‰ä»€éº¼éƒ¨é¦–ï¼Ÿ', answer: 'äºº', options: ['äºº', 'å£', 'æ‰‹', 'å¿ƒ'], hint: 'éƒ½å’Œäººæœ‰é—œ' },
            { emoji: 'ğŸ‘„ğŸ’¬', question: 'ã€Œåƒã€å¹ã€å¸ã€éƒ½æœ‰ä»€éº¼éƒ¨é¦–ï¼Ÿ', answer: 'å£', options: ['å£', 'æ‰‹', 'ç›®', 'è€³'], hint: 'éƒ½ç”¨å˜´å·´åšçš„' },
            { emoji: 'â¤ï¸ğŸ’­', question: 'ã€Œæƒ³ã€æ€ã€å¿µã€éƒ½æœ‰ä»€éº¼éƒ¨é¦–ï¼Ÿ', answer: 'å¿ƒ', options: ['å¿ƒ', 'å£', 'ç›®', 'æ‰‹'], hint: 'éƒ½å’Œå¿ƒæƒ…æ€è€ƒæœ‰é—œ' },
            { emoji: 'ğŸ–ï¸âœ‹', question: 'ã€Œæ‹¿ã€æ‰“ã€æŠ“ã€éƒ½æœ‰ä»€éº¼éƒ¨é¦–ï¼Ÿ', answer: 'æ‰‹', options: ['æ‰‹', 'å£', 'è¶³', 'ç›®'], hint: 'éƒ½ç”¨æ‰‹åšçš„' },
            { emoji: 'ğŸ‘€ğŸ‘ï¸', question: 'ã€Œçœ‹ã€çœ¼ã€ç›ã€éƒ½æœ‰ä»€éº¼éƒ¨é¦–ï¼Ÿ', answer: 'ç›®', options: ['ç›®', 'å£', 'è€³', 'æ‰‹'], hint: 'éƒ½å’Œçœ¼ç›æœ‰é—œ' },
            { emoji: 'ğŸ¦¶ğŸ‘Ÿ', question: 'ã€Œè·‘ã€è·³ã€è¸¢ã€éƒ½æœ‰ä»€éº¼éƒ¨é¦–ï¼Ÿ', answer: 'è¶³', options: ['è¶³', 'æ‰‹', 'å£', 'ç›®'], hint: 'éƒ½ç”¨è…³åšçš„' },
            { emoji: 'â˜€ï¸ğŸŒ…', question: 'ã€Œæ˜ã€æ™´ã€æ™šã€éƒ½æœ‰ä»€éº¼éƒ¨é¦–ï¼Ÿ', answer: 'æ—¥', options: ['æ—¥', 'æœˆ', 'ç«', 'æ°´'], hint: 'éƒ½å’Œå¤ªé™½æœ‰é—œ' },
            { emoji: 'ğŸŒ¾ğŸŒ±', question: 'ã€ŒèŠ±ã€è‰ã€è‘‰ã€éƒ½æœ‰ä»€éº¼éƒ¨é¦–ï¼Ÿ', answer: 'è‰¸', options: ['è‰¸', 'æœ¨', 'ç«¹', 'ç±³'], hint: 'éƒ½æ˜¯æ¤ç‰©' }
        ],
        
        // æ–°é—œå¡4ï¼šé‡è©é—œå¡
        measure: [
            { emoji: 'ğŸ', question: 'ä¸€__è˜‹æœï¼Œæ‡‰è©²ç”¨å“ªå€‹é‡è©ï¼Ÿ', answer: 'é¡†', options: ['é¡†', 'æ¢', 'éš»', 'æœ¬'], hint: 'åœ“åœ“çš„æ°´æœ' },
            { emoji: 'ğŸ•', question: 'ä¸€__ç‹—ï¼Œæ‡‰è©²ç”¨å“ªå€‹é‡è©ï¼Ÿ', answer: 'éš»', options: ['éš»', 'é¡†', 'æœ¬', 'æœµ'], hint: 'å‹•ç‰©ç”¨çš„' },
            { emoji: 'ğŸ“–', question: 'ä¸€__æ›¸ï¼Œæ‡‰è©²ç”¨å“ªå€‹é‡è©ï¼Ÿ', answer: 'æœ¬', options: ['æœ¬', 'éš»', 'é¡†', 'æœµ'], hint: 'æ›¸æœ¬ã€èª²æœ¬' },
            { emoji: 'ğŸŒ¸', question: 'ä¸€__èŠ±ï¼Œæ‡‰è©²ç”¨å“ªå€‹é‡è©ï¼Ÿ', answer: 'æœµ', options: ['æœµ', 'æœ¬', 'éš»', 'é¡†'], hint: 'èŠ±æœµã€é›²æœµ' },
            { emoji: 'ğŸš—', question: 'ä¸€__è»Šï¼Œæ‡‰è©²ç”¨å“ªå€‹é‡è©ï¼Ÿ', answer: 'è¼›', options: ['è¼›', 'éš»', 'æœ¬', 'é¡†'], hint: 'äº¤é€šå·¥å…·' },
            { emoji: 'ğŸŸ', question: 'ä¸€__é­šï¼Œæ‡‰è©²ç”¨å“ªå€‹é‡è©ï¼Ÿ', answer: 'æ¢', options: ['æ¢', 'é¡†', 'æœ¬', 'æœµ'], hint: 'é•·é•·çš„å½¢ç‹€' },
            { emoji: 'ğŸš', question: 'ä¸€__é£¯ï¼Œæ‡‰è©²ç”¨å“ªå€‹é‡è©ï¼Ÿ', answer: 'ç¢—', options: ['ç¢—', 'æœ¬', 'éš»', 'é¡†'], hint: 'è£åœ¨å®¹å™¨è£¡' },
            { emoji: 'ğŸ‘•', question: 'ä¸€__è¡£æœï¼Œæ‡‰è©²ç”¨å“ªå€‹é‡è©ï¼Ÿ', answer: 'ä»¶', options: ['ä»¶', 'éš»', 'æœ¬', 'æœµ'], hint: 'ç©¿çš„æ±è¥¿' },
            { emoji: 'âœï¸', question: 'ä¸€__ç­†ï¼Œæ‡‰è©²ç”¨å“ªå€‹é‡è©ï¼Ÿ', answer: 'æ”¯', options: ['æ”¯', 'æœ¬', 'éš»', 'é¡†'], hint: 'é•·æ¢ç‹€å·¥å…·' },
            { emoji: 'ğŸ ', question: 'ä¸€__æˆ¿å­ï¼Œæ‡‰è©²ç”¨å“ªå€‹é‡è©ï¼Ÿ', answer: 'æ£Ÿ', options: ['æ£Ÿ', 'æœ¬', 'éš»', 'æœµ'], hint: 'å»ºç¯‰ç‰©' }
        ],
        
        // æ–°é—œå¡5ï¼šå€‰é¼ ç‰¹åˆ¥é—œ(é˜¿å‡æœ€æ„›ï¼)
        hamster: [
            { emoji: 'ğŸ¹â¤ï¸', question: 'å°å€‰é¼ æœ€æ„›åƒä»€éº¼ï¼Ÿ', answer: 'ç“œå­', options: ['ç“œå­', 'é’èœ', 'é­š', 'è‚‰'], hint: 'å°å°çš„ç¨®å­' },
            { emoji: 'ğŸ¹ğŸ ', question: 'å°å€‰é¼ ä½åœ¨å“ªè£¡ï¼Ÿ', answer: 'ç± å­', options: ['ç± å­', 'æ¨¹ä¸Š', 'æ°´è£¡', 'å¤©ç©º'], hint: 'æœ‰éµçµ²çš„æˆ¿å­' },
            { emoji: 'ğŸ¹ğŸ˜´', question: 'å°å€‰é¼ ç™½å¤©å–œæ­¡åšä»€éº¼ï¼Ÿ', answer: 'ç¡è¦º', options: ['ç¡è¦º', 'è·‘æ­¥', 'æ¸¸æ³³', 'é£›ç¿”'], hint: 'é–‰ä¸Šçœ¼ç›ä¼‘æ¯' },
            { emoji: 'ğŸ¹ğŸ¡', question: 'å°å€‰é¼ æœ€æ„›ç©ä»€éº¼ç©å…·ï¼Ÿ', answer: 'æ»¾è¼ª', options: ['æ»¾è¼ª', 'ç©æœ¨', 'çƒ', 'å¨ƒå¨ƒ'], hint: 'å¯ä»¥ä¸€ç›´è·‘çš„åœ“åœ“çš„' },
            { emoji: 'ğŸ¹ğŸ‘„', question: 'å°å€‰é¼ çš„è…®å¹«å­å¯ä»¥åšä»€éº¼ï¼Ÿ', answer: 'è—é£Ÿç‰©', options: ['è—é£Ÿç‰©', 'å–æ°´', 'å”±æ­Œ', 'å‘¼å¸'], hint: 'æŠŠé£Ÿç‰©è£åœ¨å˜´å·´è£¡' },
            { emoji: 'ğŸ¹ğŸŒ™', question: 'å°å€‰é¼ ä»€éº¼æ™‚å€™æœ€æ´»æ½‘ï¼Ÿ', answer: 'æ™šä¸Š', options: ['æ™šä¸Š', 'æ—©ä¸Š', 'ä¸­åˆ', 'ä¸‹åˆ'], hint: 'å¤ªé™½ä¸‹å±±å¾Œ' },
            { emoji: 'ğŸ¹ğŸ¦·', question: 'å°å€‰é¼ çš„ç‰™é½’æœ‰ä»€éº¼ç‰¹åˆ¥ï¼Ÿ', answer: 'ä¸€ç›´é•·', options: ['ä¸€ç›´é•·', 'æœƒæ‰', 'å¾ˆè»Ÿ', 'æ²’æœ‰'], hint: 'éœ€è¦å¸¸å¸¸ç£¨ç‰™' },
            { emoji: 'ğŸ¹ğŸ‘ƒ', question: 'å°å€‰é¼ ç”¨ä»€éº¼ä¾†èªè­˜æœ‹å‹ï¼Ÿ', answer: 'é¼»å­', options: ['é¼»å­', 'çœ¼ç›', 'è€³æœµ', 'å°¾å·´'], hint: 'èä¸€èçš„å™¨å®˜' },
            { emoji: 'ğŸ¹ğŸ’›', question: 'å°å€‰é¼ æœ€å¸¸è¦‹çš„é¡è‰²æ˜¯ï¼Ÿ', answer: 'é»ƒè‰²', options: ['é»ƒè‰²', 'è—è‰²', 'ç¶ è‰²', 'ç´«è‰²'], hint: 'åƒé‡‘å­çš„é¡è‰²' },
            { emoji: 'ğŸ¹ğŸ¤²', question: 'å°å€‰é¼ æ‹¿æ±è¥¿ç”¨ä»€éº¼ï¼Ÿ', answer: 'å‰è…³', options: ['å‰è…³', 'å˜´å·´', 'å°¾å·´', 'è€³æœµ'], hint: 'åƒæ‰‹ä¸€æ¨£çš„å°çˆªå­' }
        ]
    };

    // é—œå¡è³‡è¨Š
    const levelInfo = {
        mushroom: { name: 'è˜‘è‡æ–°æ‰‹æ‘', icon: 'ğŸ„', desc: 'åŸºç¤åœ‹å­—èªè®€', requiredExp: 0 },
        oak: { name: 'æ©¡æ¨¹å°å¾‘', icon: 'ğŸŒ³', desc: 'èªè©é…å°', requiredExp: 50 },
        firefly: { name: 'è¢ç«èŸ²æ± å¡˜', icon: 'âœ¨', desc: 'é€ å¥ç·´ç¿’', requiredExp: 150 },
        treehouse: { name: 'æ™ºæ…§æ¨¹å±‹', icon: 'ğŸ ', desc: 'æˆèªå­¸ç¿’', requiredExp: 300 },
        rainbow: { name: 'å½©è™¹å±±é ‚', icon: 'ğŸŒˆ', desc: 'ç¶œåˆæŒ‘æˆ°', requiredExp: 500 },
        synonym: { name: 'åŒç¾©è©æ£®æ—', icon: 'ğŸ¤', desc: 'ç›¸ä¼¼è©å½™', requiredExp: 700 },
        antonym: { name: 'åç¾©è©å±±è°·', icon: 'âš¡', desc: 'ç›¸åè©å½™', requiredExp: 900 },
        radical: { name: 'éƒ¨é¦–ç‹åœ‹', icon: 'ğŸ°', desc: 'èªè­˜éƒ¨é¦–', requiredExp: 1100 },
        measure: { name: 'é‡è©å¯¶åº«', icon: 'ğŸ“', desc: 'é‡è©ä½¿ç”¨', requiredExp: 1300 },
        hamster: { name: 'å°å€‰é¼ æ¨‚åœ’', icon: 'ğŸ¹', desc: 'é˜¿å‡æœ€æ„›ï¼', requiredExp: 1500 }
    };

    // ç­‰ç´šç¨±è™Ÿ
    const levelTitles = {
        1: 'æ£®æ—æ–°æ‰‹',
        2: 'è˜‘è‡æ¡é›†è€…',
        3: 'æ©¡æ¨¹å®ˆè­·è€…',
        4: 'è¢ç«èŸ²æœ‹å‹',
        5: 'æ™ºæ…§å­¸å¾’',
        6: 'åœ‹èªå°é”äºº',
        7: 'å€‰é¼ å¥½æœ‹å‹',
        8: 'è©å½™å­¸è€…',
        9: 'èªæ–‡é«˜æ‰‹',
        10: 'åœ‹èªå¤§å¸«',
        15: 'å‚³å¥‡å­¸è€…'
    };

    // ===============================
    // éŠæˆ²ç‹€æ…‹
    // ===============================
    let gameState = {
        playerName: 'é˜¿å‡',
        gold: 0,
        exp: 0,
        level: 1,
        levelProgress: {
            mushroom: 0,
            oak: 0,
            firefly: 0,
            treehouse: 0,
            rainbow: 0,
            synonym: 0,
            antonym: 0,
            radical: 0,
            measure: 0,
            hamster: 0
        },
        records: [],
        soundOn: true
    };

    // ç•¶å‰éŠæˆ²ç‹€æ…‹
    let currentGame = {
        levelKey: '',
        questions: [],
        currentIndex: 0,
        score: 0,
        hearts: 3,
        results: []
    };

    // éŸ³æ•ˆä¸Šä¸‹æ–‡
    let audioContext = null;

    // ===============================
    // åˆå§‹åŒ–
    // ===============================
    function init() {
        loadGameState();
        createLeaves();
        
        // å¦‚æœå·²æœ‰å­˜æª”ï¼Œç›´æ¥é€²å…¥ä¸»é¸å–®
        if (localStorage.getItem('magicForestGameV2')) {
            document.getElementById('nameInput').value = gameState.playerName;
        }
    }

    // å‰µå»ºé£„è½æ¨¹è‘‰
    function createLeaves() {
        const container = document.getElementById('leaves-container');
        const leaves = ['ğŸƒ', 'ğŸ‚', 'ğŸŒ¿', 'â˜˜ï¸'];
        
        for (let i = 0; i < 15; i++) {
            const leaf = document.createElement('div');
            leaf.className = 'leaf';
            leaf.textContent = leaves[Math.floor(Math.random() * leaves.length)];
            leaf.style.left = Math.random() * 100 + '%';
            leaf.style.animationDuration = (5 + Math.random() * 5) + 's';
            leaf.style.animationDelay = Math.random() * 10 + 's';
            container.appendChild(leaf);
        }
    }

    // ===============================
    // è³‡æ–™å„²å­˜
    // ===============================
    function saveGameState() {
        localStorage.setItem('magicForestGameV2', JSON.stringify(gameState));
    }

    function loadGameState() {
        const saved = localStorage.getItem('magicForestGameV2');
        if (saved) {
            gameState = { ...gameState, ...JSON.parse(saved) };
        }
    }

    // ===============================
    // éŸ³æ•ˆç³»çµ±
    // ===============================
    function initAudio() {
        if (!audioContext) {
            audioContext = new (window.AudioContext || window.webkitAudioContext)();
        }
    }

    function playSound(type) {
        if (!gameState.soundOn) return;
        
        try {
            initAudio();
            
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);

            const now = audioContext.currentTime;

            switch(type) {
                case 'start':
                    // æ­¡æ¨‚ä¸Šå‡éŸ³éš
                    playMelody([262, 330, 392, 523], 0.15);
                    return;
                case 'correct':
                    // é–‹å¿ƒå®å’šè²
                    oscillator.frequency.setValueAtTime(880, now);
                    oscillator.frequency.setValueAtTime(1100, now + 0.1);
                    gainNode.gain.setValueAtTime(0.3, now);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, now + 0.3);
                    oscillator.start(now);
                    oscillator.stop(now + 0.3);
                    break;
                case 'wrong':
                    // è¼•æŸ”æç¤ºéŸ³
                    oscillator.frequency.setValueAtTime(300, now);
                    oscillator.frequency.setValueAtTime(250, now + 0.1);
                    gainNode.gain.setValueAtTime(0.2, now);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, now + 0.3);
                    oscillator.start(now);
                    oscillator.stop(now + 0.3);
                    break;
                case 'success':
                    // å‹åˆ©æ—‹å¾‹
                    playMelody([262, 294, 330, 349, 392, 440, 494, 523], 0.12);
                    return;
                case 'click':
                    // é»æ“Šè²
                    oscillator.frequency.setValueAtTime(600, now);
                    gainNode.gain.setValueAtTime(0.1, now);
                    gainNode.gain.exponentialRampToValueAtTime(0.01, now + 0.1);
                    oscillator.start(now);
                    oscillator.stop(now + 0.1);
                    break;
            }
        } catch (e) {
            console.log('éŸ³æ•ˆæ’­æ”¾å¤±æ•—:', e);
        }
    }

    function playMelody(notes, duration) {
        try {
            notes.forEach((freq, i) => {
                const osc = audioContext.createOscillator();
                const gain = audioContext.createGain();
                osc.connect(gain);
                gain.connect(audioContext.destination);
                
                const startTime = audioContext.currentTime + i * duration;
                const endTime = audioContext.currentTime + (i + 1) * duration;
                
                osc.frequency.setValueAtTime(freq, startTime);
                gain.gain.setValueAtTime(0.2, startTime);
                gain.gain.exponentialRampToValueAtTime(0.01, endTime);
                osc.start(startTime);
                osc.stop(endTime);
            });
        } catch (e) {
            console.log('æ—‹å¾‹æ’­æ”¾å¤±æ•—:', e);
        }
    }

    function toggleSound() {
        gameState.soundOn = !gameState.soundOn;
        document.getElementById('soundBtn').textContent = gameState.soundOn ? 'ğŸ”Š' : 'ğŸ”‡';
        saveGameState();
    }

    // ===============================
    // èªéŸ³æœ—è®€
    // ===============================
    function speakChinese(text) {
        if ('speechSynthesis' in window) {
            window.speechSynthesis.cancel();
            const utterance = new SpeechSynthesisUtterance(text);
            utterance.lang = 'zh-TW';
            utterance.rate = 0.8;
            utterance.pitch = 1.1;
            window.speechSynthesis.speak(utterance);
        }
    }

    function speakAnswer() {
        const answer = document.getElementById('modalAnswer').textContent;
        speakChinese(answer);
    }

    // ===============================
    // ç•«é¢åˆ‡æ›
    // ===============================
    function showScreen(screenId) {
        document.getElementById('welcomeScreen').classList.add('hidden');
        document.getElementById('mainMenu').classList.add('hidden');
        document.getElementById('gameScreen').classList.add('hidden');
        document.getElementById('resultScreen').classList.add('hidden');
        
        document.getElementById(screenId).classList.remove('hidden');
        document.getElementById(screenId).style.display = screenId === 'welcomeScreen' ? 'flex' : 'block';
    }

    // ===============================
    // éŠæˆ²é–‹å§‹
    // ===============================
    function startGame() {
        const name = document.getElementById('nameInput').value.trim();
        if (!name) {
            alert('è«‹è¼¸å…¥ä½ çš„åå­—ï¼');
            return;
        }
        
        gameState.playerName = name;
        saveGameState();
        
        playSound('start');
        showScreen('mainMenu');
        updatePlayerCard();
        renderLevelCards();
    }

    // ===============================
    // ç©å®¶è³‡è¨Šæ›´æ–°
    // ===============================
    function updatePlayerCard() {
        document.getElementById('playerName').textContent = gameState.playerName;
        document.getElementById('goldDisplay').textContent = gameState.gold;
        document.getElementById('expDisplay').textContent = gameState.exp;
        
        // è¨ˆç®—ç­‰ç´š
        gameState.level = Math.floor(gameState.exp / 100) + 1;
        const titleLevel = Math.min(gameState.level, 6);
        document.getElementById('playerTitle').textContent = `Lv.${gameState.level} ${levelTitles[titleLevel] || 'åœ‹èªå°é”äºº'}`;
        
        // ç¶“é©—å€¼é€²åº¦æ¢
        const expInLevel = gameState.exp % 100;
        document.getElementById('expProgress').textContent = `${expInLevel}/100`;
        document.getElementById('expBarFill').style.width = `${expInLevel}%`;
    }

    // ===============================
    // é—œå¡å¡ç‰‡æ¸²æŸ“
    // ===============================
    function renderLevelCards() {
        const grid = document.getElementById('levelsGrid');
        grid.innerHTML = '';
        
        const levelKeys = ['mushroom', 'oak', 'firefly', 'treehouse', 'rainbow'];
        
        levelKeys.forEach(key => {
            const info = levelInfo[key];
            const isLocked = gameState.exp < info.requiredExp;
            const progress = gameState.levelProgress[key] || 0;
            
            const card = document.createElement('div');
            card.className = `level-card ${isLocked ? 'locked' : ''}`;
            card.innerHTML = `
                <div class="level-header ${key}"></div>
                <div class="level-content">
                    <div class="level-icon">${info.icon}</div>
                    <div class="level-name">${info.name}</div>
                    <div class="level-desc">${info.desc}</div>
                    <div class="level-progress">
                        <div class="level-progress-fill" style="width: ${progress * 10}%"></div>
                    </div>
                    <div class="level-score">æœ€é«˜ï¼š${progress}/10</div>
                </div>
                ${isLocked ? `
                    <div class="level-lock-overlay">
                        <div class="lock-icon">ğŸ”’</div>
                        <div class="lock-text">éœ€è¦ ${info.requiredExp} ç¶“é©—å€¼</div>
                    </div>
                ` : ''}
            `;
            
            if (!isLocked) {
                card.onclick = () => startLevel(key);
            }
            
            grid.appendChild(card);
        });
    }

    // ===============================
    // é–‹å§‹é—œå¡
    // ===============================
    function startLevel(levelKey) {
        playSound('click');
        
        currentGame = {
            levelKey: levelKey,
            questions: [],
            currentIndex: 0,
            score: 0,
            hearts: 3,
            results: []
        };
        
        // æº–å‚™é¡Œç›®
        if (levelKey === 'rainbow') {
            // å½©è™¹å±±é ‚ï¼šç¶œåˆæŒ‘æˆ°
            const allQuestions = [];
            // 3é¡Œåœ‹å­—
            allQuestions.push(...shuffleArray(questionBank.mushroom).slice(0, 3));
            // 3é¡Œèªè©
            allQuestions.push(...shuffleArray(questionBank.oak).slice(0, 3));
            // 2é¡Œé€ å¥
            allQuestions.push(...shuffleArray(questionBank.firefly).slice(0, 2));
            // 2é¡Œæˆèª
            allQuestions.push(...shuffleArray(questionBank.treehouse).slice(0, 2));
            currentGame.questions = shuffleArray(allQuestions);
        } else {
            currentGame.questions = shuffleArray([...questionBank[levelKey]]);
        }
        
        showScreen('gameScreen');
        updateGameHeader();
        showQuestion();
    }

    // æ´—ç‰Œå‡½æ•¸
    function shuffleArray(array) {
        const newArray = [...array];
        for (let i = newArray.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
        }
        return newArray;
    }

    // ===============================
    // éŠæˆ²ç•«é¢æ›´æ–°
    // ===============================
    function updateGameHeader() {
        const info = levelInfo[currentGame.levelKey];
        document.getElementById('gameLevelName').innerHTML = `${info.icon} ${info.name}`;
        document.getElementById('gameProgress').textContent = `ç¬¬ ${currentGame.currentIndex + 1}/10 é¡Œ`;
        
        // æ›´æ–°æ„›å¿ƒ
        const heartsContainer = document.getElementById('gameHearts');
        heartsContainer.innerHTML = '';
        for (let i = 0; i < 3; i++) {
            const heart = document.createElement('span');
            heart.className = 'heart' + (i >= currentGame.hearts ? ' lost' : '');
            heart.textContent = 'â¤ï¸';
            heartsContainer.appendChild(heart);
        }
    }

    function showQuestion() {
        const question = currentGame.questions[currentGame.currentIndex];
        
        document.getElementById('questionImage').textContent = question.emoji;
        document.getElementById('questionText').textContent = question.question;
        document.getElementById('questionHint').textContent = question.hint;
        
        // éš¨æ©Ÿæ’åˆ—é¸é …
        const shuffledOptions = shuffleArray([...question.options]);
        
        const grid = document.getElementById('answersGrid');
        grid.innerHTML = '';
        
        shuffledOptions.forEach(option => {
            const btn = document.createElement('button');
            btn.className = 'answer-btn';
            btn.textContent = option;
            btn.onclick = () => checkAnswer(option);
            grid.appendChild(btn);
        });
    }

    // ===============================
    // æª¢æŸ¥ç­”æ¡ˆ
    // ===============================
    function checkAnswer(selected) {
        const question = currentGame.questions[currentGame.currentIndex];
        const isCorrect = selected === question.answer;
        
        // ç¦ç”¨æ‰€æœ‰æŒ‰éˆ•
        const buttons = document.querySelectorAll('.answer-btn');
        buttons.forEach(btn => {
            btn.disabled = true;
            if (btn.textContent === question.answer) {
                btn.classList.add('correct');
            } else if (btn.textContent === selected && !isCorrect) {
                btn.classList.add('wrong');
            }
        });
        
        // è¨˜éŒ„çµæœ
        currentGame.results.push({
            question: question,
            userAnswer: selected,
            correct: isCorrect
        });
        
        if (isCorrect) {
            currentGame.score++;
            playSound('correct');
            
            setTimeout(() => {
                nextQuestion();
            }, 800);
        } else {
            currentGame.hearts--;
            playSound('wrong');
            updateGameHeader();
            
            // é¡¯ç¤ºå­¸ç¿’æç¤º
            setTimeout(() => {
                showLearnModal(question, selected);
            }, 800);
        }
    }

    // ===============================
    // å­¸ç¿’æç¤ºå½ˆçª—
    // ===============================
    function showLearnModal(question, userAnswer) {
        document.getElementById('modalAnswer').textContent = question.answer;
        document.getElementById('modalHint').textContent = question.hint;
        document.getElementById('modalYourAnswer').textContent = userAnswer;
        document.getElementById('learnModal').classList.add('show');
        
        // è‡ªå‹•æœ—è®€æ­£ç¢ºç­”æ¡ˆ
        setTimeout(() => {
            speakChinese(question.answer);
        }, 500);
    }

    function closeLearnModal() {
        document.getElementById('learnModal').classList.remove('show');
        nextQuestion();
    }

    // ===============================
    // ä¸‹ä¸€é¡Œ
    // ===============================
    function nextQuestion() {
        currentGame.currentIndex++;
        
        // æª¢æŸ¥æ˜¯å¦éŠæˆ²çµæŸ
        if (currentGame.currentIndex >= 10 || currentGame.hearts <= 0) {
            endGame();
            return;
        }
        
        updateGameHeader();
        showQuestion();
    }

    // ===============================
    // éŠæˆ²çµæŸ
    // ===============================
    function endGame() {
        const passed = currentGame.score >= 6;
        const earnedExp = currentGame.score * 5;
        const earnedGold = currentGame.score * 10;
        
        // æ›´æ–°éŠæˆ²ç‹€æ…‹
        gameState.exp += earnedExp;
        gameState.gold += earnedGold;
        
        // æ›´æ–°é—œå¡æœ€é«˜åˆ†
        if (currentGame.score > gameState.levelProgress[currentGame.levelKey]) {
            gameState.levelProgress[currentGame.levelKey] = currentGame.score;
        }
        
        // è¨˜éŒ„
        gameState.records.push({
            level: currentGame.levelKey,
            score: currentGame.score,
            passed: passed,
            date: new Date().toLocaleDateString('zh-TW')
        });
        
        saveGameState();
        
        // éŸ³æ•ˆ
        playSound(passed ? 'success' : 'wrong');
        
        // é¡¯ç¤ºçµæœ
        showResultScreen(passed, earnedExp, earnedGold);
    }

    function showResultScreen(passed, earnedExp, earnedGold) {
        showScreen('resultScreen');
        
        if (passed) {
            document.getElementById('resultIcon').textContent = 'ğŸ‰';
            document.getElementById('resultTitle').textContent = `${gameState.playerName}å¥½æ£’ï¼`;
            document.getElementById('resultTitle').className = 'result-title success';
            document.getElementById('resultMessage').textContent = 'ä½ åˆå­¸æœƒäº†å¥½å¤šåœ‹å­—ï¼ç¹¼çºŒåŠ æ²¹ï¼Œæˆç‚ºåœ‹èªå°é”äººï¼';
        } else {
            document.getElementById('resultIcon').textContent = 'ğŸ¦Š';
            document.getElementById('resultTitle').textContent = 'æ²’é—œä¿‚ï¼';
            document.getElementById('resultTitle').className = 'result-title retry';
            document.getElementById('resultMessage').textContent = `å¤šç·´ç¿’å¹¾æ¬¡ï¼Œ${gameState.playerName}ä¸€å®šå¯ä»¥çš„ï¼æˆ‘å€‘å†è©¦ä¸€æ¬¡å§ï¼`;
        }
        
        document.getElementById('resultScore').textContent = `${currentGame.score}/10`;
        document.getElementById('resultExp').textContent = `+${earnedExp}`;
        document.getElementById('resultGold').textContent = `+${earnedGold}`;
        
        // æ¸²æŸ“è¤‡ç¿’å€åŸŸ
        renderReview();
    }

    // ===============================
    // è¤‡ç¿’å€åŸŸ
    // ===============================
    function renderReview() {
        const container = document.getElementById('reviewContent');
        container.innerHTML = '';
        
        // åˆ†é¡ï¼šç­”éŒ¯å’Œç­”å°
        const wrongAnswers = currentGame.results.filter(r => !r.correct);
        const rightAnswers = currentGame.results.filter(r => r.correct);
        
        // ç­”éŒ¯çš„é¡Œç›®ï¼ˆéœ€è¦åŠ å¼·ï¼‰
        if (wrongAnswers.length > 0) {
            const wrongSection = document.createElement('div');
            wrongSection.innerHTML = `<div class="review-subtitle">âŒ éœ€è¦åŠ å¼·è¤‡ç¿’</div>`;
            
            const wrongItems = document.createElement('div');
            wrongItems.className = 'review-items';
            
            wrongAnswers.forEach(result => {
                wrongItems.appendChild(createReviewItem(result, true));
            });
            
            wrongSection.appendChild(wrongItems);
            container.appendChild(wrongSection);
        }
        
        // ç­”å°çš„é¡Œç›®
        if (rightAnswers.length > 0) {
            const rightSection = document.createElement('div');
            rightSection.innerHTML = `<div class="review-subtitle correct">âœ… ç­”å°çš„é¡Œç›®</div>`;
            
            const rightItems = document.createElement('div');
            rightItems.className = 'review-items';
            
            rightAnswers.forEach(result => {
                rightItems.appendChild(createReviewItem(result, false));
            });
            
            rightSection.appendChild(rightItems);
            container.appendChild(rightSection);
        }
    }

    function createReviewItem(result, isWrong) {
        const item = document.createElement('div');
        item.className = `review-item ${isWrong ? 'wrong' : 'right'}`;
        
        item.innerHTML = `
            <div class="review-emoji">${result.question.emoji}</div>
            <div class="review-content">
                <div class="review-answer">
                    ${isWrong ? '' : 'â­ '}${result.question.answer}
                </div>
                <div class="review-hint">ğŸ’¡ ${result.question.hint}</div>
                ${isWrong ? `<div class="review-wrong-answer">ä½ çš„ç­”æ¡ˆï¼š${result.userAnswer}</div>` : ''}
            </div>
            <button class="review-speak-btn" onclick="speakChinese('${result.question.answer}')">ğŸ”Š</button>
        `;
        
        return item;
    }

    // ===============================
    // è¿”å›èˆ‡é‡è©¦
    // ===============================
    function backToMenu() {
        playSound('click');
        showScreen('mainMenu');
        updatePlayerCard();
        renderLevelCards();
    }

    function retryLevel() {
        playSound('click');
        startLevel(currentGame.levelKey);
    }

    // ===============================
    // é é¢è¼‰å…¥
    // ===============================
    window.onload = init;
</script>

</body>
</html>
